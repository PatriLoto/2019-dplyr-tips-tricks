---
title: "Rladies"
subtitle: "⚔<br/> Resistencia Corrientes"
author: "Trucos y tips de dplyr"
date: "-- de Agosto de 2019"
output:
  xaringan::moon_reader:
    css: ["default", "rladies", "rladies-fonts"]
---
```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```
class: center, middle

# Bienvenidas!!

---

class: inverse, center, middle

# ¿Qué vamos a ver hoy?
### 1° Parte: Funciones útiles 
### 2° Parte: Funciones Principales
### 3° Parte: Otras funcionalidades

---
# Dataset: Gapminder
```{r eval=FALSE, tidy=FALSE}
install.packages("gapminder")
```

.pull-left[
```{r plot-last, fig.show = 'hide', warning=FALSE, message=FALSE}
library(ggplot2)
library(gapminder)
library(dplyr)
ggplot(filter(gapminder, year==2007), aes(x = gdpPercap, y = lifeExp)) +
  scale_x_log10(labels = scales::dollar) +
  geom_point(aes(size = pop, fill = continent), shape = 21, colour = "white", alpha = 0.6) +
  scale_fill_brewer(palette = "Set2") +
  scale_size_continuous(range = c(1, 20)) +
  labs(title = "",
       subtitle = "Relationship between life expectancy and income, 2007",
       caption = "Source: Gapminder.org",
       x = "GDP per capita ($)",
       y = "Age (years)") +
  guides(size = FALSE) +
  theme(panel.grid.major.x = element_blank(),
        legend.position = "right", 
        legend.title = element_blank())
```
]
.pull-right[
```{r ref.label = 'plot-last', echo = FALSE}
```
]
---
```{r message=FALSE, warning=FALSE, eval=FALSE}
library(gganimate)
```

```{r tidy=FALSE, warning=FALSE, message=FALSE, echo=FALSE}
library(gganimate)
ggplot(gapminder, aes(gdpPercap, lifeExp, size = pop, colour = country)) +
  geom_point(alpha = 0.7) +
  scale_colour_manual(values = country_colors) +
  scale_size(range = c(2, 12)) +
  scale_x_log10() +
  facet_wrap(~continent) +
  theme(legend.position = 'none') +
  labs(title = 'Year: {frame_time}', x = 'GDP per capita', y = 'life expectancy') +
  transition_time(year)
```


---
# data.frame vs. tibble
- Los data.frame son estructuras nativas de rbase y están disponibles sin necesidad de instalar ningún paquete adicional. Es una estructura tabular organizada en filas y columnas. Se puede acceder a las columnas mediantes colnames(df) y los nombres de las filas, como rownames(df).
- Los tibble sin embargo, son parte de tidyverse. También presentan una estructura tabular, en filas y columnas. Los tibbles eliminan los rownames por defecto, para tener mejor compatibilidad con bases de datos SQL.

- Ambas formas son intercambiables mediante los comandos

```{r message=FALSE, warning=FALSE, eval=FALSE}
as.data.frame()
as_tibble()
```


---
class: inverse, middle, center

# Funciones Útiles

---
# Funciones Útiles
###Cargamos el paquete dplyr
```{r message=FALSE, warning=FALSE}
library(dplyr)
library(gapminder)
```
--
## head()
```{r }
head(gapminder)
```

---
#Funciones Útiles 
## tail()
```{r }
tail(gapminder)
```


---
#Funciones Útiles
## glimpse()
```{r }
glimpse(gapminder)
```


---
#Funciones Útiles
## slice()
```{r gapminder, warning=FALSE}
dplyr::slice(gapminder, 5L)
```

---
#Funciones Útiles
## str()

```{r }
str(gapminder)
```

---
#Funciones Útiles
## summary()

```{r }
summary(gapminder)
```

---
class: inverse, middle, center

# Operador pipe 
# %>%

---
# Operador pipe
- El operador pipe nos permite concatenar funciones y objetos en R, de forma que el código tenga un aspecto más ordenado, siguiendo la filosofía de tidyverse. 

---
class: inverse, middle, center

# Funciones principales de dplyr 

---

class: middle, center

## select(): extraer columnas
## filter(): extraer filas siguiendo una restricción lógica
## mutate(): derivar nuevas variables
## summarise(): cambiar la unidad de análisis
## arrange(): organizar filas por variables

---

# select()

```{r }
gap1<- gapminder %>%
  select(country, lifeExp, gdpPercap)
head(gap1)
```

.footnote[[*]
Mas información en https://dplyr.tidyverse.org/reference/select.html]

---

# filter()

```{r }
gap2<- gapminder %>%
  filter(lifeExp > 80)
head(gap2)
```

.footnote[[*]
Mas información en https://dplyr.tidyverse.org/reference/filter.html]
---

# mutate()

```{r }
gap3<- gapminder %>%
  mutate(lifeExp > 80)
head(gap3)
```


.footnote[[*] 
Más información en https://dplyr.tidyverse.org/reference/mutate.html]

---
# summarise()


```{r message=FALSE, warning=FALSE}
gdp_bycontinents <- gapminder %>%
    group_by(continent) %>%
    summarize(mean_gdpPercap=mean(gdpPercap))
gdp_bycontinents
```

.footnote[[*] 
Más información en https://dplyr.tidyverse.org/reference/summarise.html]
---
# arrange()



```{r message=FALSE, warning=FALSE}

```

.footnote[[*] 
Más información en https://dplyr.tidyverse.org/reference/arrange.html]
---

class: inverse, middle, center

# Otras funcionalidades de dplyr

---
class: inverse, middle, center

# Vamos a combinar los verbos anteriores con 
# dplyr_all
# dplyr_if
# dplyr_at

---
class: inverse, middle, center

# dplyr_all: realizar una operación a todas las variables
# dplyr_if: realizar una operación en un set de variables que fueron seleccionadas según sus características
# dplyr_at: realizar una operación en un set de variables basados en los nombres de las variables

---
# select_all()

- Permite seleccionar todas las columnas y aplicar una operación a todas las columnas

```{r message=FALSE, warning=FALSE}
gap4 <- gapminder %>%
    select_all(toupper)
gap4
```

---

-Para deshacer el cambio anterior
```{r message=FALSE, warning=FALSE}
gap5 <- gapminder %>%
    select_all(tolower)
gap5
```

---

# select_if()

- Permite seleccionar las columnas teniendo en cuenta alguna condición

```{r message=FALSE, warning=FALSE}
gap6 <- gapminder %>%
  select_if(is.numeric)
gap6
```
---

## filter_all(): filtrar según las condicione que se indican
--
## filter_if():requiere una función que retorne un booleano para indicar que columnas serán filtradas. Si es verdadero, se ejecutará la orden
--
## 

---
